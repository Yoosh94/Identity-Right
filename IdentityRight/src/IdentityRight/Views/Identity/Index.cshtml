@model IndexViewModel
@{
    ViewData["Title"] = "Manage your identity";
}

<h2>@ViewData["Title"].</h2>
<p class="text-success">@ViewData["StatusMessage"]</p>

<div>
    <h4>Change your account settings</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>Password:</dt>
        <dd>
            @if (Model.HasPassword)
            {
                <a asp-controller="Identity" asp-action="ChangePassword">Change Password</a>
            }
        </dd>
        <dt>Phone Number:</dt>
        <dd>
            We use phone numbers as a second factor of verification.
            <br/>
            Phone Number:
            @(Model.PhoneNumber ?? "No Phone Number Added")
            @if (Model.PhoneNumber != null)
            {
                <form asp-controller="Identity" asp-action="RemovePhoneNumber" method="post" role="form"><button type="submit" class="btn-link">
                    Remove Phone Number
                </button></form>
            }
            else
            {
                <a asp-controller="Identity" asp-action="AddPhoneNumber">Add Phone Number</a>
            }
        </dd>

        <dt>Two-Factor Authentication:</dt>
        <dd>
            @if (Model.TwoFactor)
            {
                <form asp-controller="Identity" asp-action="DisableTwoFactorAuthentication" method="post" class="form-horizontal" role="form">
                    Current Status: Enabled <button type="submit" class="btn-link">Disable</button>
                </form>
            }
            else
            {
                <form asp-controller="Identity" asp-action="EnableTwoFactorAuthentication" method="post" class="form-horizontal" role="form">
                    Current Status: Disabled <button type="submit" class="btn-link">Enable</button>
                </form>
            }
        </dd>
    </dl>
    <hr/>

    @if (Model.Organisations.Count != 1)
    {
        <h4>@Model.Organisations.Count Linked Organisations</h4>
    }
    else
    {
        <h4>@Model.Organisations.Count Linked Organisation</h4>
    }

    @if (Model.Organisations.Count > 0)
    {
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Organisation Name</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var organisation in Model.Organisations)
                {
                    <tr>
                        <td>@organisation.organisationName</td>
                        <td>@Html.ActionLink("View Organisation Profile", "Organisation", "Organisations", new { organisationId = organisation.Id })</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>You are not linked to any organisations</p>
    }
</div>
